<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="流水不争先,争的是滔滔不绝"><title>从Dos攻击到新冠状病毒 | Hi!老王!</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="generator" content="Hexo 4.0.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">从Dos攻击到新冠状病毒</h1><a id="logo" href="/.">Hi!老王!</a><p class="description">王浩</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">从Dos攻击到新冠状病毒</h1><div class="post-meta">Feb 5, 2020<span> | </span><span class="category"><a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.9k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 10</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Dos攻击"><span class="toc-number">1.</span> <span class="toc-text">Dos攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#宽带消耗型攻击"><span class="toc-number">1.1.</span> <span class="toc-text">宽带消耗型攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#资源消耗型攻击"><span class="toc-number">1.2.</span> <span class="toc-text">资源消耗型攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#防御方式"><span class="toc-number">1.3.</span> <span class="toc-text">防御方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#防火墙"><span class="toc-number">1.3.1.</span> <span class="toc-text">防火墙</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#入侵检测系统"><span class="toc-number">1.3.2.</span> <span class="toc-text">入侵检测系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Snort"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Snort</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#参考文献"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">参考文献</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#武汉加油！"><span class="toc-number">2.</span> <span class="toc-text">武汉加油！</span></a></li></ol></div></div><div class="post-content"><!-- toc -->

<h1 id="Dos攻击"><a href="#Dos攻击" class="headerlink" title="Dos攻击"></a>Dos攻击</h1><p><strong>拒绝服务攻击</strong>（英语：denial-of-service attack，简称DoS攻击）亦称洪水攻击，是一种网络攻击手法，其目的在于使目标电脑的网络或系统资源耗尽，使服务暂时中断或停止，导致其正常用户无法访问。DDoS攻击可以具体分成两种形式：<strong>带宽消耗型</strong>以及<strong>资源消耗型</strong>。它们都是透过大量合法或伪造的请求占用大量网络以及器材资源，以达到瘫痪网络以及系统的目的。</p>
<h2 id="宽带消耗型攻击"><a href="#宽带消耗型攻击" class="headerlink" title="宽带消耗型攻击"></a>宽带消耗型攻击</h2><p>DDoS宽带消耗攻击可以分为两个不同的层次：<strong>洪泛攻击</strong>或<strong>放大攻击</strong>。洪泛攻击的特点是利用僵尸程序发送大量流量至受损的受害者系统，目的在于堵塞其宽带。放大攻击与其类似，是通过恶意放大流量限制受害者系统的宽带；其特点是利用僵尸程序通过伪造的源IP(即攻击目标IP)向某些存在漏洞的服务器发送请求，服务器在处理请求后向伪造的源IP发送应答，由于这些服务的特殊性导致应答包比请求包更长，因此使用少量的宽带就能使服务器发送大量的应答到目标主机上。</p>
<ul>
<li><p><strong>UDP洪水攻击</strong>（User Datagram Protocol floods）</p>
<p>UDP（用户数据报协议）是一种无连接协议，当数据包通过UDP发送时，所有的数据包在发送和接收时不需要进行握手验证。当大量UDP数据包发送给受害系统时，可能会导致带宽饱和从而使得合法服务无法请求访问受害系统。遭受DDoS UDP洪泛攻击时，UDP数据包的目的端口可能是随机或指定的端口，受害系统将尝试处理接收到的数据包以确定本地运行的服务。如果没有应用程序在目标端口运行，受害系统将对源IP发出ICMP数据包，表明“目标端口不可达”。某些情况下，攻击者会伪造源IP地址以隐藏自己，这样从受害系统返回的数据包不会直接回到僵尸主机，而是被发送到被伪造地址的主机。有时UDP洪泛攻击也可能影响受害系统周围的网络连接，这可能导致受害系统附近的正常系统遇到问题。</p>
</li>
<li><p><strong>ICMP洪水攻击</strong>（ICMP floods）</p>
<p>ICMP（互联网控制消息协议）洪水攻击是通过向未良好设置的路由器发送广播信息占用系统资源的做法。</p>
</li>
<li><p><strong>死亡之Ping</strong>（ping of death）</p>
<p>死亡之Ping是产生超过IP协议能容忍的数据包数，若系统没有检查机制，就会死机。</p>
</li>
<li><p><strong>泪滴攻击</strong></p>
<p>每个数据要发送前，该数据包都会经过切割，每个小切割都会记录位移的信息，以便重组，但此攻击模式就是捏造位移信息，造成重组时发生问题，造成错误。</p>
</li>
</ul>
<h2 id="资源消耗型攻击"><a href="#资源消耗型攻击" class="headerlink" title="资源消耗型攻击"></a>资源消耗型攻击</h2><ul>
<li><p><strong>协议分析攻击</strong>（SYN flood，SYN洪水）</p>
<p>传送控制协议（TCP）同步（SYN）攻击。TCP进程通常包括发送者和接受者之间在数据包发送之前创建的完全信号交换。启动系统发送一个SYN请求，接收系统返回一个带有自己SYN请求的ACK（确认）作为交换。发送系统接着传回自己的ACK来授权两个系统间的通讯。若接收系统发送了SYN数据包，但没接收到ACK，接受者经过一段时间后会再次发送新的SYN数据包。接受系统中的处理器和内存资源将存储该TCP SYN的请求直至超时。DDoS TCP SYN攻击也被称为“资源耗尽攻击”，它利用TCP功能将僵尸程序伪装的TCP SYN请求发送给受害服务器，从而饱和服务处理器资源并阻止其有效地处理合法请求。它专门利用发送系统和接收系统间的三向信号交换来发送大量欺骗性的原IP地址TCP SYN数据包给受害系统。最终，大量TCP SYN攻击请求反复发送，导致受害系统内存和处理器资源耗尽，致使其无法处理任何合法用户的请求。</p>
</li>
<li><p><strong>LAND攻击</strong></p>
<p>这种攻击方式与SYN floods类似，不过在LAND攻击包中的原地址和目标地址都是攻击对象的IP。这种攻击会导致被攻击的机器死循环，最终耗尽资源而死机。</p>
</li>
<li><p><strong>CC攻击</strong>（Distributed HTTP flood，分布式HTTP洪水攻击）</p>
<p>CC攻击是DDoS攻击的一种类型，使用代理服务器向受害服务器发送大量貌似合法的请求（通常使用HTTP GET)。CC（Challenge Collapsar，挑战黑洞）根据其工具命名，攻击者创造性地使用代理机制，利用众多广泛可用的免费代理服务器发动DDoS攻击。许多免费代理服务器支持匿名模式，这使追踪变得非常困难。</p>
</li>
<li><p><strong>僵尸网络攻击</strong></p>
<p>僵尸网络是指大量被命令与控制（C&amp;C）服务器所控制的互联网主机群。攻击者传播恶意软件并组成自己的僵尸网络。僵尸网络难于检测的原因是，僵尸主机只有在执行特定指令时才会与服务器进行通讯，使得它们隐蔽且不易察觉。僵尸网络根据网络通讯协议的不同分为IRC、HTTP或P2P类等。</p>
</li>
<li><p><strong>应用程序级洪水攻击</strong>（Application level floods）</p>
<p>与前面叙说的攻击方式不同，应用程序级洪水攻击主要是针对应用软件层的，也就是高于OSI的。它同样是以大量消耗系统资源为目的，通过向IIS这样的网络服务程序提出无节制的资源申请来迫害正常的网络服务。</p>
<h2 id="防御方式"><a href="#防御方式" class="headerlink" title="防御方式"></a>防御方式</h2><p>故宫有四个门，游客只能从午门买票安检进入，从神武门和东华门出。在计算机中我们要借用这种策略，当通信流量进入/离开网络时要执行安全检查，做记录、丢弃或转发，这些工作由防火墙、入侵检测系统(IDS)和入侵防止系统(IPS)的运行设备完成。</p>
<h3 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h3><p>防火墙(firewall)是一个软硬件结合体，它将一个机构的内部网络和外部网络分隔开。Linux系统使用<strong>iptables</strong>命令产生一个防火墙，CentOS下可以使用<strong>firewall-cmd</strong>命令。防火墙可以分为三类：<strong>传统分组过滤器</strong>(traditional packet filter)，<strong>状态过滤器</strong>(stateful filter)和<strong>应用程序网关</strong>(application gateway)。</p>
<ul>
<li><p><strong>传统分组过滤器</strong>独立地检查每个数据报，然后基于管理员制定的规则决定数据报如何处理，通过还是丢弃。过略决定通常基于下列因素：</p>
<ul>
<li>IP源或目的地址</li>
<li>IP数据报中的协议类型字段：TCP、UDP、ICMP、OSPF等</li>
<li>TCP标志比特：SYN、ACK等</li>
<li>ICMP报文类型</li>
<li>数据报离开或进入网络的不同规则</li>
<li>对不同路由器接口的不同规则</li>
</ul>
<table>
<thead>
<tr>
<th align="center">动作</th>
<th align="center">源地址</th>
<th align="center">目的地址</th>
<th align="center">协议</th>
<th align="center">源端口</th>
<th align="center">目的端口</th>
<th align="center">标志比特</th>
</tr>
</thead>
<tbody><tr>
<td align="center">允许</td>
<td align="center">222.22/16</td>
<td align="center">222.22/16的外部</td>
<td align="center">TCP</td>
<td align="center">&gt;1023</td>
<td align="center">80</td>
<td align="center">任意</td>
</tr>
<tr>
<td align="center">允许</td>
<td align="center">222.22/16的外部</td>
<td align="center">222.22/16</td>
<td align="center">TCP</td>
<td align="center">80</td>
<td align="center">&gt;1023</td>
<td align="center">ACK</td>
</tr>
<tr>
<td align="center">允许</td>
<td align="center">222.22/16</td>
<td align="center">222.22/16的外部</td>
<td align="center">UDP</td>
<td align="center">&gt;1023</td>
<td align="center">53</td>
<td align="center">—</td>
</tr>
<tr>
<td align="center">允许</td>
<td align="center">222.22/16的外部</td>
<td align="center">222.22/16</td>
<td align="center">UDP</td>
<td align="center">53</td>
<td align="center">&gt;1023</td>
<td align="center">—</td>
</tr>
<tr>
<td align="center">允许</td>
<td align="center">全部</td>
<td align="center">全部</td>
<td align="center">全部</td>
<td align="center">全部</td>
<td align="center">全部</td>
<td align="center">全部</td>
</tr>
</tbody></table>
<pre><code>表 1</code></pre><p>表1显示了某机构222.22/16的访问控制列表的例子。前两条规则一起允许内部用户在Web上冲浪：第一条规则允许任何目的端口为80的TCP分组离开该机构网络，第二条规则允许任何源端口为80且ACK比特置位的TCP分组进入该机构网络，注意如果有外部主机试图与一台内部主机建立TCP连接，该连接将会被阻挡(建立连接时SYN字段置位，ACK字段不置位)；接下来的两条规则允许DNS流量进入和离开该机构网络。这张表限制除Web和DNS流量外的所有流量。</p>
</li>
<li><p>重新看一下表1，它是允许任何来自外部ACK=1且源端口为80的TCP分组通过的，试想一下，这样的分组是能够被用来异常分组来攻击网络的，<strong>状态过滤器</strong>通过维护一张连接表来解决问题，过滤器通过对比连接表和限制表来确保安全，例如一个连接60秒没有任何活动，过滤器就假设该连接结束了。</p>
</li>
<li><p><strong>应用程序网关</strong></p>
</li>
</ul>
<h3 id="入侵检测系统"><a href="#入侵检测系统" class="headerlink" title="入侵检测系统"></a>入侵检测系统</h3><p>分组过滤器检查IP、TCP、UDP和ICMP首部字段。然而，为了检测多种攻击类型，我们需要执行<strong>深度分组检查</strong>(deep packet inspection)，即检查首部以外的数据部分。这就需要两种设备，一种是<strong>入侵检测系统</strong>(Intrusion Detection System，IDS)，负责观察潜在恶意流量产生告警；一种是<strong>入侵防止系统</strong>(Intrusion Prevention System，IPS)，这两种系统统称为<strong>IDS系统</strong>。<strong>IDS系统</strong>大致分为<strong>基于特征的系统</strong>(signature-based system)和<strong>基于异常的系统</strong>(anomaly-based system)。</p>
<ul>
<li><p><strong>基于特征</strong>的IDS维护了一个攻击特性数据库，IDS运行流程如下：</p>
<ol>
<li>嗅探每个通过它的数据组</li>
<li>将分组与数据库中的特征进行比较</li>
<li>倘若特征匹配，IDS产生告警，发送Email给管理员或做成日志</li>
</ol>
<p>基于特征的IDS的缺陷：</p>
<ol>
<li>IDS基于过往的攻击特征做比对，缺乏对新攻击的判断力</li>
<li>即使与一个特征匹配，也可能不是一个攻击，因此产生了虚假告警</li>
<li>为了解决第二个缺陷，分组必须与一个特征集合做对比，IDS可能处于一种过载状态并因此难以检测出许多恶意分组</li>
</ol>
</li>
<li><p><strong>基于异常</strong>的IDS观察正常运行的流量时，会产生一个流量概况文件，然后它寻找统计上不寻常的分组流，例如ICMP分组不寻常的百分比，端口扫描或Ping掠过导致指数性突然增长。基于异常的IDS的最大特点是不依赖现有攻击的知识，另一方面，区分正常流量和异常流量是一个挑战，不过机器学习的发展肯定有了一定的成果，之后查资料再做补充。</p>
</li>
</ul>
<h4 id="Snort"><a href="#Snort" class="headerlink" title="Snort"></a>Snort</h4><p><strong>Snort</strong>是一个开放源码的IDS，能够运行在Linux、Unix和Windows系统上，使用了通用的嗅探接口<strong>libpcap</strong>，<strong>Wireshark</strong>。来看一个Snort的例子：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alert icmp $EXTERNAL_NET any -&gt;$HOME_NET any</span><br><span class="line">(msg:"ICMP PING NMAP"; dsize: 0; itype: 8;)</span><br></pre></td></tr></table></figure>

<p>这个特征由外部网络($EXTERNAL_NET)进入内部网络($HOME_NET)的任何ICMP分组所匹配，其类型是8(ICMP ping)并具有空负载(dsize=0)。因为nmap用这些特定的特征产生这些ping分组，所以设计出该特征来检测nmap的ping扫描，当某分组匹配到这些特征时，Snort产生一个“ICMP PING NMAP”的警告。</p>
</li>
</ul>
<h4 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h4><h1 id="武汉加油！"><a href="#武汉加油！" class="headerlink" title="武汉加油！"></a>武汉加油！</h1></div><div class="tags"><a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a><a href="/tags/Dos%E6%94%BB%E5%87%BB/">Dos攻击</a><a href="/tags/%E4%B8%AD%E5%9B%BD%E5%8A%A0%E6%B2%B9/">中国加油</a></div><div class="post-nav"><a class="next" href="/2019/11/21/2019-11-21-%E5%85%B3%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/">关于数据库的一些技巧</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">数据结构与算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 15px;">数据库</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size: 15px;">排序</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="font-size: 15px;">网络安全</a> <a href="/tags/Dos%E6%94%BB%E5%87%BB/" style="font-size: 15px;">Dos攻击</a> <a href="/tags/%E4%B8%AD%E5%9B%BD%E5%8A%A0%E6%B2%B9/" style="font-size: 15px;">中国加油</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/02/05/2020-02-05-%E4%BB%8EDos%E6%94%BB%E5%87%BB%E5%88%B0%E6%96%B0%E5%86%A0%E7%8A%B6%E7%97%85%E6%AF%92/">从Dos攻击到新冠状病毒</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/21/2019-11-21-%E5%85%B3%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/">关于数据库的一些技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/21/2019-11-21-%E5%B8%B8%E7%94%A8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/">常用排序算法</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Hi!老王!.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>